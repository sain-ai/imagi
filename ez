<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>DigitalBridge - íš¨ë„ ëª¨ë“œ (Full List)</title>
  <meta name="viewport" content="width=device-width,initial-scale=1.0,user-scalable=no" />
  <style>
    /* --- [1. ê¸°ë³¸ ì„¤ì • (ê³ ëŒ€ë¹„, í° ê¸€ì”¨)] --- */
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      background: #000;
      font-family: "Apple SD Gothic Neo", "Malgun Gothic", sans-serif;
      color: #fff;
    }
    
    .phone {
      width: 100%;
      max-width: 450px;
      height: 95vh;
      background: #121212;
      border-radius: 20px;
      position: relative;
      overflow: hidden;
      display: flex;
      flex-direction: column;
      border: 2px solid #333;
    }

    /* --- [2. í™”ë©´ ê³µí†µ] --- */
    .screen {
      flex: 1;
      display: none;
      flex-direction: column;
      padding: 20px;
      padding-bottom: 90px; /* í•˜ë‹¨ ë²„íŠ¼ ê³µê°„ í™•ë³´ */
      overflow-y: auto; /* ë‚´ìš© ë§ìœ¼ë©´ ìŠ¤í¬ë¡¤ */
    }
    .screen.active { display: flex; }
    .screen.center-layout { justify-content: center; align-items: center; text-align: center; }

    /* ìƒë‹¨ í—¤ë” */
    .top-header {
      padding: 20px;
      background: #1f1f1f;
      display: flex;
      justify-content: space-between;
      align-items: center;
      border-bottom: 2px solid #333;
    }
    .app-title { font-size: 24px; font-weight: bold; color: #fff; }
    .mode-badge { background: #444; padding: 5px 15px; border-radius: 20px; font-size: 16px; }

    /* â˜… í•˜ë‹¨ ê³ ì • ë‚´ë¹„ê²Œì´ì…˜ â˜… */
    .bottom-nav {
      position: absolute; bottom: 0; left: 0; right: 0;
      height: 80px; background: #1f1f1f; border-top: 2px solid #333;
      display: flex; z-index: 100;
    }
    .nav-btn {
      flex: 1; border: none; background: none; color: #fff;
      font-size: 18px; font-weight: bold;
      display: flex; flex-direction: column; justify-content: center; align-items: center; gap: 5px;
      cursor: pointer;
    }
    .nav-btn:active { background: #333; }
    .nav-btn.home { border-right: 1px solid #333; background: #222; }
    .nav-btn.back { background: #222; }

    /* --- [3. ë©”ë‰´ ë²„íŠ¼ ìŠ¤íƒ€ì¼] --- */
    .big-menu-container {
      display: flex; flex-direction: column; gap: 20px; height: 100%; justify-content: center;
    }
    .big-btn {
      flex: 1; border-radius: 25px; border: none; padding: 20px;
      display: flex; align-items: center; justify-content: space-between;
      text-align: left; cursor: pointer; transition: transform 0.1s;
    }
    .big-btn:active { transform: scale(0.98); }
    
    .btn-blue { background: #2563eb; color: #fff; }
    .btn-green { background: #16a34a; color: #fff; }
    .btn-red { background: #dc2626; color: #fff; }
    .btn-gray { background: #374151; color: #fff; }

    .btn-text { display: flex; flex-direction: column; gap: 5px; }
    .btn-title { font-size: 30px; font-weight: 800; line-height: 1.2; }
    .btn-sub { font-size: 18px; opacity: 0.9; font-weight: normal; }
    .btn-icon { font-size: 50px; opacity: 0.9; }

    /* --- [4. ëª©ë¡ ìŠ¤íƒ€ì¼ (í™•ëŒ€)] --- */
    .list-item {
      background: #333; padding: 30px 25px; margin-bottom: 15px; border-radius: 15px;
      font-size: 26px; font-weight: bold; display: flex; justify-content: space-between; align-items: center;
      border: 1px solid #555;
    }
    .list-item:active { background: #2563eb; border-color: #2563eb; }

    /* ê°€ì´ë“œ í™”ë©´ */
    .guide-box { background: #2d2d2d; padding: 25px; border-radius: 20px; margin-bottom: 20px; text-align: center; }
    .guide-step-num { background: #2563eb; color: #fff; display: inline-block; padding: 5px 15px; border-radius: 20px; font-weight: bold; margin-bottom: 15px; font-size: 18px; }
    .guide-text { font-size: 24px; line-height: 1.5; margin-bottom: 15px; }
    .guide-img { font-size: 80px; margin: 10px 0; }

    /* ìŒì„±/ì±„íŒ… */
    .voice-ui { flex: 1; display: flex; flex-direction: column; align-items: center; justify-content: center; text-align: center; gap: 30px; }
    .mic-circle {
      width: 150px; height: 150px; background: #16a34a; border-radius: 50%;
      display: flex; justify-content: center; align-items: center; font-size: 70px;
      animation: pulse 1.5s infinite;
    }
    @keyframes pulse { 0% { box-shadow: 0 0 0 0 rgba(22, 163, 74, 0.7); } 70% { box-shadow: 0 0 0 30px rgba(22, 163, 74, 0); } 100% { box-shadow: 0 0 0 0 rgba(22, 163, 74, 0); } }
    .chat-input-row { width: 100%; display: flex; gap: 10px; margin-top: 20px; }
    .big-input { flex: 1; height: 60px; border-radius: 15px; border: 2px solid #555; background: #000; color: #fff; font-size: 20px; padding: 0 15px; }
    .big-send-btn { width: 80px; height: 60px; background: #2563eb; color: #fff; border: none; border-radius: 15px; font-size: 20px; font-weight: bold; }

    /* --- [5. ì†ì£¼ ëª¨ë“œ] --- */
    .gc-card { background: #222; padding: 25px; border-radius: 20px; margin-bottom: 20px; border: 1px solid #444; text-align: center; }
    .match-btn { width: 100%; padding: 25px; font-size: 22px; font-weight: bold; border-radius: 20px; border: none; cursor: pointer; margin-top: 15px; }
    .btn-on { background: #2563eb; color: white; }
    .btn-off { background: #dc2626; color: white; }
    .radar-scanner { width: 120px; height: 120px; background: rgba(56,189,248,0.1); border-radius: 50%; border: 1px solid rgba(56,189,248,0.3); position: relative; margin: 20px auto; display: flex; justify-content: center; align-items: center; }
    .radar-scanner::after { content: ''; position: absolute; width: 100%; height: 100%; border-radius: 50%; background: conic-gradient(transparent, rgba(56,189,248,0.4)); animation: radarSpin 2s linear infinite; }
    @keyframes radarSpin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }

    /* --- [6. í‰ê°€ íŒì—…] --- */
    .feedback-overlay {
      position: absolute; inset: 0; background: rgba(0,0,0,0.95); z-index: 200;
      display: none; flex-direction: column; justify-content: center; align-items: center;
    }
    .feedback-overlay.show { display: flex; }
    .stars-container { display: flex; gap: 15px; margin: 30px 0; }
    .star { font-size: 50px; cursor: pointer; color: #4b5563; transition: color 0.2s; }
    .star.filled { color: #fbbf24; }
    .feedback-btn { padding: 15px 50px; border-radius: 99px; background: #2563eb; color: white; border: none; font-size: 20px; font-weight: bold; cursor: pointer; }
    .thankyou-msg {
      position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
      font-size: 32px; font-weight: 800; color: #38bdf8;
      opacity: 0; transition: opacity 0.5s ease; pointer-events: none; width: 100%; text-align: center;
    }
    .feedback-input-group { transition: opacity 0.5s ease; width: 100%; display: flex; flex-direction: column; align-items: center; }

  </style>
</head>
<body>

  <div class="phone">
    
    <div class="top-header">
      <div class="app-title">ë””ì§€í„¸ ë¸Œë¦¿ì§€</div>
      <div class="mode-badge" id="header-mode-text">ëª¨ë“œ ì„ íƒ</div>
    </div>

    <div id="screen-role" class="screen active center-layout" style="padding-bottom: 20px;">
      <h2 style="font-size: 32px; margin-bottom: 40px;">ëˆ„êµ¬ì‹ ê°€ìš”?</h2>
      <div style="width: 100%; display: flex; flex-direction: column; gap: 20px;">
        <button class="big-btn btn-blue" style="height: 160px;" onclick="setMode('grandparent')">
          <div class="btn-text">
            <span class="btn-title">ì–´ë¥´ì‹ </span>
            <span class="btn-sub">ë°°ìš°ê¸° / ë„ì›€ ìš”ì²­</span>
          </div>
          <span class="btn-icon">ğŸ‘µ</span>
        </button>
        <button class="big-btn btn-gray" style="height: 160px;" onclick="setMode('grandchild')">
          <div class="btn-text">
            <span class="btn-title">ì†ì£¼ (ë´‰ì‚¬ì)</span>
            <span class="btn-sub">ë„ì™€ì£¼ëŸ¬ ì™”ì–´ìš”</span>
          </div>
          <span class="btn-icon">ğŸ§‘â€ğŸ’»</span>
        </button>
      </div>
    </div>

    <div id="screen-home" class="screen">
      <div class="big-menu-container">
        <button class="big-btn btn-blue" onclick="startUsageFlow()">
          <div class="btn-text">
            <span class="btn-title">ê³µë¶€í•˜ê¸°</span>
            <span class="btn-sub">ê¸°ê³„ ì‚¬ìš©ë²• ë³´ê¸°</span>
          </div>
          <span class="btn-icon">ğŸ“˜</span>
        </button>
        <button class="big-btn btn-green" onclick="startVoiceSearch()">
          <div class="btn-text">
            <span class="btn-title">ë§ë¡œ ì°¾ê¸°</span>
            <span class="btn-sub">"ì¹´í†¡ ê¸€ì í¬ê²Œ"</span>
          </div>
          <span class="btn-icon">ğŸ¤</span>
        </button>
        <button class="big-btn btn-red" onclick="startEmergencyCall()">
          <div class="btn-text">
            <span class="btn-title">ì†ì£¼ ë¶€ë¥´ê¸°</span>
            <span class="btn-sub">ì ‘ì† ì¤‘ì¸ ë´‰ì‚¬ì ì—°ê²°</span>
          </div>
          <span class="btn-icon">ğŸš¨</span>
        </button>
        <button class="big-btn btn-gray" style="flex: 0.5;" onclick="startFaq()">
          <div class="btn-text">
            <span class="btn-title" style="font-size: 22px;">ìì£¼ ë¬»ëŠ” ì§ˆë¬¸</span>
          </div>
          <span class="btn-icon">â“</span>
        </button>
      </div>
    </div>

    <div id="screen-list" class="screen">
      <h2 id="list-title" style="margin-bottom: 20px; font-size: 28px;">ëª©ë¡</h2>
      <div id="list-container"></div>
    </div>

    <div id="screen-guide" class="screen">
      <h2 id="guide-title" style="margin-bottom: 20px; color: #38bdf8;">ì‚¬ìš©ë²•</h2>
      <div id="guide-content"></div>
      <button class="big-btn btn-blue" style="flex:0; justify-content:center;" onclick="goHome()">
        <span style="font-size:24px; font-weight:bold;">ì²˜ìŒìœ¼ë¡œ ëŒì•„ê°€ê¸°</span>
      </button>
    </div>

    <div id="screen-voice" class="screen">
      <div class="voice-ui">
        <div class="mic-circle" id="mic-icon" onclick="toggleMic()">ğŸ¤</div>
        <h2 id="voice-msg" style="font-size: 32px;">ëˆŒëŸ¬ì„œ ë§ì”€í•˜ì„¸ìš”</h2>
        <div class="chat-input-row">
          <input type="text" class="big-input" id="chat-input" placeholder="ì§ì ‘ ì…ë ¥í•˜ê¸°">
          <button class="big-send-btn" onclick="sendChat()">ê²€ìƒ‰</button>
        </div>
      </div>
    </div>

    <div id="screen-call" class="screen center-layout">
      <div style="text-align: center;">
        <div style="font-size: 100px; margin-bottom: 20px;">ğŸ§‘â€ğŸ’»</div>
        <h2 style="font-size: 32px; margin-bottom: 10px;" id="call-status">ì—°ê²° ì¤‘...</h2>
        <p style="font-size: 24px; color: #aaa; margin-bottom: 50px;" id="call-timer">00:00</p>
        <button class="big-btn btn-red" style="width: 100%; justify-content: center;" onclick="endCall()">
          <span style="font-size: 28px; font-weight: bold;">í†µí™” ì¢…ë£Œ</span>
        </button>
      </div>
    </div>

    <div id="screen-grandchild" class="screen">
      <div class="gc-card">
        <h3 style="color:#aaa; margin-bottom:10px;">í˜„ì¬ ìƒíƒœ</h3>
        <div style="font-size:28px; font-weight:bold; margin-bottom:20px;" id="gc-status-text">ëŒ€ê¸° ì¤‘ì§€ (OFF)</div>
        <div id="radar-area" style="display:none;">
          <div class="radar-scanner"><span style="font-size:40px;">ğŸ“¡</span></div>
          <p style="color:#38bdf8;">ë„ì›€ ìš”ì²­ì„ ê¸°ë‹¤ë¦¬ê³  ìˆìŠµë‹ˆë‹¤...</p>
        </div>
        <div id="sleep-area" style="font-size:60px; margin:20px;">ğŸ’¤</div>
        <button class="match-btn btn-on" id="match-toggle-btn" onclick="toggleMatch()">ë´‰ì‚¬ ëŒ€ê¸° ì‹œì‘ (ON)</button>
      </div>
      <div class="gc-card" style="text-align:left;">
        <h3 style="color:#aaa; margin-bottom:15px;">ë‚´ í™œë™ ë‚´ì—­</h3>
        <div style="font-size:18px; margin-bottom:10px;">âœ… 10ë¶„ ì „ - í‚¤ì˜¤ìŠ¤í¬ ì„¤ëª…</div>
        <div style="font-size:18px;">âœ… ì–´ì œ - ì™€ì´íŒŒì´ ì—°ê²°</div>
      </div>
    </div>

    <div id="feedback-popup" class="feedback-overlay">
      <div class="feedback-input-group" id="fb-group">
        <h2 style="font-size: 32px; margin-bottom: 15px;">ê°ì‚¬í•©ë‹ˆë‹¤!</h2>
        <p style="font-size: 22px; color: #ccc;">í•™ìƒì´ ì¹œì ˆí–ˆë‚˜ìš”?</p>
        <div class="stars-container">
          <span class="star filled" onclick="rateStar(1)">â˜…</span>
          <span class="star filled" onclick="rateStar(2)">â˜…</span>
          <span class="star filled" onclick="rateStar(3)">â˜…</span>
          <span class="star filled" onclick="rateStar(4)">â˜…</span>
          <span class="star filled" onclick="rateStar(5)">â˜…</span>
        </div>
        <button class="feedback-btn" onclick="finishFeedback()">í‰ê°€ ì™„ë£Œ</button>
      </div>
      <div class="thankyou-msg" id="fb-thankyou">ì´ìš©í•´ì£¼ì…”ì„œ ê°ì‚¬í•©ë‹ˆë‹¤!</div>
    </div>

    <div class="bottom-nav" id="bottom-nav" style="display:none;">
      <button class="nav-btn home" onclick="goHome()">
        <span class="nav-icon">ğŸ </span><span>ì²˜ìŒìœ¼ë¡œ</span>
      </button>
      <button class="nav-btn back" onclick="goBack()">
        <span class="nav-icon">â†©ï¸</span><span>ë’¤ë¡œê°€ê¸°</span>
      </button>
    </div>

  </div>

  <script>
    /* --- [ë°ì´í„°: ê¸°ê¸° ëª©ë¡ ëŒ€í­ ì¶”ê°€] --- */
    const data = {
      "ì „ê¸° ë°¥ì†¥": { icon: "ğŸš", steps: ["ëšœê»‘ì„ ì—´ê³  ìŒ€ì„ ë„£ìœ¼ì„¸ìš”.", "ëšœê»‘ì„ ë‹«ê³  ì†ì¡ì´ë¥¼ ëŒë ¤ ì ê·¸ì„¸ìš”.", "'ì·¨ì‚¬' ë˜ëŠ” 'ë°±ë¯¸' ë²„íŠ¼ì„ ê¾¹ ëˆ„ë¥´ì„¸ìš”."] },
      "ì„¸íƒê¸°": { icon: "ğŸ‘•", steps: ["ë¹¨ë˜ë¥¼ ë„£ê³  ë¬¸ì„ ë‹«ìœ¼ì„¸ìš”.", "ì„¸ì œí†µì— ì„¸ì œë¥¼ í•œ ìŠ¤í‘¼ ë„£ìœ¼ì„¸ìš”.", "ì „ì› ì¼œê³  ë™ì‘(ì¬ìƒ) ë²„íŠ¼ì„ ëˆ„ë¥´ì„¸ìš”."] },
      "ìŠ¤ë§ˆíŠ¸í°": { icon: "ğŸ“±", steps: ["ì„¤ì •(í†±ë‹ˆë°”í€´) ì•„ì´ì½˜ì„ ëˆ„ë¥´ì„¸ìš”.", "ë””ìŠ¤í”Œë ˆì´(í™”ë©´) ë©”ë‰´ë¥¼ ì°¾ìœ¼ì„¸ìš”.", "ê¸€ì í¬ê¸°ë¥¼ í¬ê²Œ ì¡°ì ˆí•˜ì„¸ìš”."] },
      "í‚¤ì˜¤ìŠ¤í¬": { icon: "ğŸ”", steps: ["í™”ë©´ì„ ì†ìœ¼ë¡œ í„°ì¹˜í•˜ì„¸ìš”.", "ë¨¹ê³  ê°ˆì§€ í¬ì¥í• ì§€ ê³ ë¥´ì„¸ìš”.", "ì¹´ë“œ êµ¬ë©ì— ì¹´ë“œë¥¼ ê½‚ìœ¼ì„¸ìš”."] },
      "ì „ìë ˆì¸ì§€": { icon: "ğŸ±", steps: ["ì†ì¡ì´ë¥¼ ë‹¹ê²¨ ë¬¸ì„ ì—¬ì„¸ìš”.", "ìŒì‹ì„ ë„£ê³  ë¬¸ì„ ë‹«ìœ¼ì„¸ìš”.", "ì‹œì‘ ë²„íŠ¼ì´ë‚˜ 30ì´ˆ ë²„íŠ¼ì„ ëˆ„ë¥´ì„¸ìš”."] },
      "ì—ì–´í”„ë¼ì´ì–´": { icon: "ğŸ¤", steps: ["ì†ì¡ì´ë¥¼ ë‹¹ê²¨ ë°”êµ¬ë‹ˆë¥¼ êº¼ë‚´ì„¸ìš”.", "ìŒì‹ì„ ë„£ê³  ë‹¤ì‹œ ë°€ì–´ ë„£ìœ¼ì„¸ìš”.", "ë‹¤ì´ì–¼ì„ ëŒë ¤ ì‹œê°„(10ë¶„)ì„ ë§ì¶”ì„¸ìš”."] },
      "TV ë¦¬ëª¨ì»¨": { icon: "ğŸ“º", steps: ["ë¹¨ê°„ìƒ‰ ì „ì› ë²„íŠ¼ì„ ëˆ„ë¥´ì„¸ìš”.", "ìˆ«ì ë²„íŠ¼ìœ¼ë¡œ ì±„ë„ì„ ëˆ„ë¥´ì„¸ìš”.", "ì†Œë¦¬ê°€ ì•ˆ ë‚˜ë©´ ì˜†ë©´ + ë²„íŠ¼ì„ ëˆ„ë¥´ì„¸ìš”."] },
      "ì—ì–´ì»¨": { icon: "â„ï¸", steps: ["ë¦¬ëª¨ì»¨ì˜ ìš´ì „/ì •ì§€ ë²„íŠ¼ì„ ëˆ„ë¥´ì„¸ìš”.", "ì˜¨ë„ ë‚´ë¦¼(â–¼) ë²„íŠ¼ì„ ëˆŒëŸ¬ ì‹œì›í•˜ê²Œ í•˜ì„¸ìš”.", "ë°”ëŒ ì„¸ê¸° ë²„íŠ¼ìœ¼ë¡œ ë°”ëŒì„ ì¡°ì ˆí•˜ì„¸ìš”."] },
      "ë³´ì¼ëŸ¬": { icon: "ğŸ”¥", steps: ["ì „ì› ë²„íŠ¼ì„ ëˆŒëŸ¬ ì¼œì„¸ìš”.", "ëª©ìš• ë²„íŠ¼ì„ ëˆ„ë¥´ë©´ ì˜¨ìˆ˜ê°€ ë‚˜ì˜µë‹ˆë‹¤.", "ë‚œë°© ë‹¤ì´ì–¼ì„ ëŒë ¤ ì˜¨ë„ë¥¼ ë†’ì´ì„¸ìš”."] }
    };

    const faq = [
      {t: "ì™€ì´íŒŒì´ê°€ ì•ˆ ë¼ìš”", d: "ê³µìœ ê¸°(ë„¤ëª¨ë‚œ ê¸°ê³„) ì½”ë“œë¥¼ ëºë‹¤ê°€ ë‹¤ì‹œ ê½‚ì•„ë³´ì„¸ìš”."},
      {t: "ì†Œë¦¬ê°€ ë„ˆë¬´ ì‘ì•„ìš”", d: "ê¸°ê³„ ì˜†ë©´ì— ìˆëŠ” ë²„íŠ¼ì„ ìœ„ë¡œ ëˆ„ë¥´ì„¸ìš”."},
      {t: "í™”ë©´ì´ ë„ˆë¬´ ì–´ë‘ì›Œìš”", d: "í™”ë©´ ìœ„ìª½ì„ ì†ê°€ë½ìœ¼ë¡œ ì“¸ì–´ë‚´ë ¤ ë°ê¸° ë§‰ëŒ€ë¥¼ ì¡°ì ˆí•˜ì„¸ìš”."}
    ];

    /* --- ìƒíƒœ ë³€ìˆ˜ --- */
    let historyStack = [];
    let isMatching = false;
    let callTimer;

    /* --- í™”ë©´ ì´ë™ ë¡œì§ --- */
    function showScreen(id) {
      document.querySelectorAll('.screen').forEach(el => el.classList.remove('active'));
      document.getElementById(id).classList.add('active');
      
      const nav = document.getElementById('bottom-nav');
      if (id === 'screen-role') {
        nav.style.display = 'none';
        historyStack = [];
      } else {
        nav.style.display = 'flex';
      }
    }

    function setMode(mode) {
      const title = document.getElementById('header-mode-text');
      if(mode === 'grandparent') {
        title.innerText = "ì–´ë¥´ì‹  ëª¨ë“œ";
        pushHistory('screen-home');
      } else {
        title.innerText = "ì†ì£¼(ë´‰ì‚¬ì) ëª¨ë“œ";
        pushHistory('screen-grandchild');
      }
    }

    function pushHistory(id) {
      showScreen(id);
      historyStack.push(id);
    }

    function goBack() {
      if (historyStack.length > 1) {
        historyStack.pop();
        showScreen(historyStack[historyStack.length - 1]);
      } else {
        showScreen('screen-role');
      }
    }

    function goHome() {
      const mode = document.getElementById('header-mode-text').innerText;
      if (mode.includes("ì–´ë¥´ì‹ ")) {
        historyStack = ['screen-home'];
        showScreen('screen-home');
      } else {
        historyStack = ['screen-grandchild'];
        showScreen('screen-grandchild');
      }
    }

    /* --- ê¸°ëŠ¥ 1: ì‚¬ìš©ë²• (ëª©ë¡ ì±„ìš°ê¸°) --- */
    function startUsageFlow() {
      const con = document.getElementById('list-container');
      document.getElementById('list-title').innerText = "ì–´ë–¤ ê¸°ê³„ì¸ê°€ìš”?";
      con.innerHTML = '';
      
      // ë°ì´í„°ì— ìˆëŠ” ëª¨ë“  ê¸°ê¸°ë¥¼ ëª©ë¡ìœ¼ë¡œ ë§Œë“¦
      Object.keys(data).forEach(key => {
        const div = document.createElement('div');
        div.className = 'list-item';
        div.innerHTML = `<span>${key}</span><span>${data[key].icon}</span>`;
        div.onclick = () => showGuide(key);
        con.appendChild(div);
      });
      pushHistory('screen-list');
    }

    function showGuide(key) {
      const item = data[key];
      const con = document.getElementById('guide-content');
      document.getElementById('guide-title').innerText = key + " ì‚¬ìš©ë²•";
      con.innerHTML = '';

      item.steps.forEach((step, idx) => {
        con.innerHTML += `
          <div class="guide-box">
            <div class="guide-step-num">${idx + 1}ë‹¨ê³„</div>
            <div class="guide-text">${step}</div>
          </div>
        `;
      });
      pushHistory('screen-guide');
    }

    function startFaq() {
      const con = document.getElementById('list-container');
      document.getElementById('list-title').innerText = "ìì£¼ ë¬»ëŠ” ì§ˆë¬¸";
      con.innerHTML = '';
      faq.forEach(item => {
        const div = document.createElement('div');
        div.className = 'list-item';
        div.style.display = 'block';
        div.innerHTML = `<div style="font-size:20px; color:#38bdf8; margin-bottom:5px;">Q. ${item.t}</div><div style="font-size:18px; color:#ddd; font-weight:normal;">A. ${item.d}</div>`;
        con.appendChild(div);
      });
      pushHistory('screen-list');
    }

    /* --- ê¸°ëŠ¥ 2: ìŒì„± ê²€ìƒ‰ --- */
    function startVoiceSearch() {
      pushHistory('screen-voice');
      document.getElementById('voice-msg').innerText = "ëˆŒëŸ¬ì„œ ë§ì”€í•˜ì„¸ìš”";
    }

    function toggleMic() {
      const msg = document.getElementById('voice-msg');
      const mic = document.getElementById('mic-icon');
      msg.innerText = "ë“£ê³  ìˆìŠµë‹ˆë‹¤...";
      mic.style.background = "#dc2626"; 
      
      setTimeout(() => {
        msg.innerText = "í™•ì¸í–ˆìŠµë‹ˆë‹¤!";
        mic.style.background = "#16a34a";
        document.getElementById('chat-input').value = "ë°¥ì†¥";
        sendChat();
      }, 2000);
    }

    function sendChat() {
      const val = document.getElementById('chat-input').value;
      let found = false;
      // í‚¤ì›Œë“œë¡œ ê¸°ê¸° ì°¾ê¸°
      Object.keys(data).forEach(key => {
        if (val.includes(key) || (val.includes("ë°¥") && key==="ì „ê¸° ë°¥ì†¥") || (val.includes("í°") && key==="ìŠ¤ë§ˆíŠ¸í°")) {
          showGuide(key);
          found = true;
        }
      });
      
      if(!found) {
        if(val.includes("ì¹´í†¡") || val.includes("ê¸€ì")) showGuide("ìŠ¤ë§ˆíŠ¸í°");
        else alert("ì£„ì†¡í•´ìš”. ì•„ì§ ë°°ìš°ê³  ìˆëŠ” ì¤‘ì´ì—ìš”.");
      }
    }

    /* --- ê¸°ëŠ¥ 3: ê¸´ê¸‰ í˜¸ì¶œ --- */
    function startEmergencyCall() {
      pushHistory('screen-call');
      const status = document.getElementById('call-status');
      const timer = document.getElementById('call-timer');
      
      status.innerText = "ë´‰ì‚¬ì ì°¾ëŠ” ì¤‘...";
      timer.innerText = "ì ì‹œë§Œ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš”";

      setTimeout(() => {
        status.innerText = "ê¹€ì² ìˆ˜ í•™ìƒ (ì—°ê²°ë¨)";
        let sec = 0;
        clearInterval(callTimer);
        callTimer = setInterval(() => {
          sec++;
          timer.innerText = "í†µí™” ì‹œê°„ : " + sec + "ì´ˆ";
        }, 1000);
      }, 2000);
    }

    function endCall() {
      clearInterval(callTimer);
      document.getElementById('feedback-popup').classList.add('show');
    }

    function closeFeedback() {
      document.getElementById('feedback-popup').classList.remove('show');
      goHome();
    }

    /* --- ì†ì£¼ ëª¨ë“œ --- */
    function toggleMatch() {
      const btn = document.getElementById('match-toggle-btn');
      const stat = document.getElementById('gc-status-text');
      const radar = document.getElementById('radar-area');
      const sleep = document.getElementById('sleep-area');

      isMatching = !isMatching;

      if (isMatching) {
        btn.innerText = "ëŒ€ê¸° ì¢…ë£Œ (OFF)";
        btn.className = "match-btn btn-off";
        stat.innerText = "ë§¤ì¹­ ëŒ€ê¸° ì¤‘... (ON)";
        stat.style.color = "#38bdf8";
        radar.style.display = "block";
        sleep.style.display = "none";
      } else {
        btn.innerText = "ë´‰ì‚¬ ëŒ€ê¸° ì‹œì‘ (ON)";
        btn.className = "match-btn btn-on";
        stat.innerText = "ëŒ€ê¸° ì¤‘ì§€ (OFF)";
        stat.style.color = "#aaa";
        radar.style.display = "none";
        sleep.style.display = "block";
      }
    }

    /* --- í‰ê°€ ë¡œì§ --- */
    function rateStar(score) {
      const stars = document.querySelectorAll('.stars-container .star');
      stars.forEach((star, index) => {
        if (index < score) {
          star.classList.add('filled'); star.innerText = 'â˜…';
        } else {
          star.classList.remove('filled'); star.innerText = 'â˜†';
        }
      });
    }

    function finishFeedback() {
      const inputUI = document.getElementById('fb-group');
      const msgUI = document.getElementById('fb-thankyou');
      
      inputUI.style.opacity = '0';
      msgUI.style.opacity = '1';

      setTimeout(() => {
        msgUI.style.opacity = '0';
        setTimeout(() => {
          document.getElementById('feedback-popup').classList.remove('show');
          goHome();
          // UI ì´ˆê¸°í™”
          inputUI.style.opacity = '1';
          msgUI.style.opacity = '0';
          rateStar(5);
        }, 500);
      }, 2000);
    }
  </script>
</body>
</html>
